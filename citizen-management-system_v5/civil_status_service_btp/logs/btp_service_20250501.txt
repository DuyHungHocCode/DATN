2025-05-01 16:11:56,988 - app.main - INFO - BTP Civil Status Service starting, logs will be saved to: logs/btp_service_20250501.txt
2025-05-01 16:11:56,990 - app.main - INFO - Civil Status Service starting up...
2025-05-01 16:11:56,990 - app.main - INFO - Testing Kafka connection...
2025-05-01 16:14:28,433 - app.main - INFO - Civil Status Service shutting down...
2025-05-01 16:14:28,433 - kafka.producer.kafka - INFO - Closing the Kafka producer with 9223372036.0 secs timeout.
2025-05-01 16:14:28,434 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:29092 <connected> [IPv4 ('127.0.0.1', 29092)]>: Closing connection. 
2025-05-01 16:14:28,434 - app.services.kafka_producer - INFO - Kafka producer closed.
2025-05-01 16:14:28,939 - app.main - INFO - BTP Civil Status Service starting, logs will be saved to: logs/btp_service_20250501.txt
2025-05-01 16:14:28,939 - app.main - INFO - Info message - testing logging
2025-05-01 16:14:28,939 - app.main - WARNING - Warning message - testing logging
2025-05-01 16:14:28,940 - app.main - ERROR - Error message - testing logging
2025-05-01 16:14:28,941 - app.main - INFO - Civil Status Service starting up...
2025-05-01 16:14:28,941 - app.main - INFO - Testing Kafka connection...
2025-05-01 16:15:05,448 - app.api.router - INFO - Received request to register death certificate for citizen: 345678901234
2025-05-01 16:15:05,553 - httpx - INFO - HTTP Request: GET http://localhost:8000/api/v1/citizens/345678901234 "HTTP/1.1 200 OK"
2025-05-01 16:15:05,555 - app.api.router - INFO - Citizen 345678901234 validation successful (status: None). Proceeding with registration.
2025-05-01 16:15:05,558 - app.api.router - INFO - Successfully created death certificate record with ID: 4
2025-05-01 16:15:05,558 - app.api.router - INFO - Added Kafka event sending task to background for certificate ID: 4
2025-05-01 16:15:05,559 - app.services.kafka_producer - INFO - Sending event to Kafka topic: btp_events
2025-05-01 16:15:05,560 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:29092 <connecting> [IPv4 ('127.0.0.1', 29092)]>: connecting to localhost:29092 [('127.0.0.1', 29092) IPv4]
2025-05-01 16:15:05,560 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:29092 <connected> [IPv4 ('127.0.0.1', 29092)]>: Connection complete.
2025-05-01 16:15:05,561 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:29092 <connected> [IPv4 ('127.0.0.1', 29092)]>: Closing connection. 
2025-05-01 16:15:05,566 - app.services.kafka_producer - INFO - Event sent successfully to topic: btp_events, partition: 0, offset: 9
2025-05-01 16:16:44,826 - httpx - INFO - HTTP Request: GET http://localhost:8000/health "HTTP/1.1 200 OK"
2025-05-01 16:25:27,838 - app.api.router - INFO - Received request to register death certificate for citizen: 123456789012
2025-05-01 16:25:27,863 - httpx - INFO - HTTP Request: GET http://localhost:8000/api/v1/citizens/123456789012 "HTTP/1.1 200 OK"
2025-05-01 16:25:27,864 - app.api.router - INFO - Citizen 123456789012 validation successful (status: None). Proceeding with registration.
2025-05-01 16:25:27,874 - app.api.router - INFO - Successfully created death certificate record with ID: 7
2025-05-01 16:25:27,874 - app.api.router - INFO - Added Kafka event sending task to background for certificate ID: 7
2025-05-01 16:25:27,875 - app.services.kafka_producer - INFO - Sending event to Kafka topic: btp_events
2025-05-01 16:25:27,878 - app.services.kafka_producer - INFO - Event sent successfully to topic: btp_events, partition: 0, offset: 10
2025-05-01 16:35:40,135 - app.api.router - INFO - Received request to register death certificate for citizen: 234567890123
2025-05-01 16:35:40,165 - httpx - INFO - HTTP Request: GET http://localhost:8000/api/v1/citizens/234567890123 "HTTP/1.1 200 OK"
2025-05-01 16:35:40,166 - app.api.router - INFO - Citizen 234567890123 validation successful (status: None). Proceeding with registration.
2025-05-01 16:35:40,176 - app.api.router - INFO - Successfully created death certificate record with ID: 8
2025-05-01 16:35:40,176 - app.api.router - INFO - Added Kafka event sending task to background for certificate ID: 8
2025-05-01 16:35:40,178 - app.services.kafka_producer - INFO - Sending event to Kafka topic: btp_events
2025-05-01 16:35:40,181 - app.services.kafka_producer - INFO - Event sent successfully to topic: btp_events, partition: 0, offset: 11
2025-05-01 16:35:40,311 - app.api.router - INFO - Received request to register death certificate for citizen: 345678901234
2025-05-01 16:35:40,336 - httpx - INFO - HTTP Request: GET http://localhost:8000/api/v1/citizens/345678901234 "HTTP/1.1 200 OK"
2025-05-01 16:35:40,336 - app.api.router - INFO - Citizen 345678901234 validation successful (status: None). Proceeding with registration.
2025-05-01 16:35:40,345 - app.api.router - INFO - Successfully created death certificate record with ID: 9
2025-05-01 16:35:40,346 - app.api.router - INFO - Added Kafka event sending task to background for certificate ID: 9
2025-05-01 16:35:40,346 - app.services.kafka_producer - INFO - Sending event to Kafka topic: btp_events
2025-05-01 16:35:40,350 - app.services.kafka_producer - INFO - Event sent successfully to topic: btp_events, partition: 0, offset: 12
2025-05-01 19:56:03,895 - kafka.conn - ERROR - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:29092 <connected> [IPv4 ('127.0.0.1', 29092)]>: Closing connection. KafkaConnectionError: Socket EVENT_READ without in-flight-requests
2025-05-01 19:56:03,900 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:29092 <connecting> [IPv4 ('127.0.0.1', 29092)]>: connecting to localhost:29092 [('127.0.0.1', 29092) IPv4]
2025-05-01 19:56:03,901 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:29092 <connected> [IPv4 ('127.0.0.1', 29092)]>: Connection complete.
2025-05-02 10:12:43,936 - kafka.conn - ERROR - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:29092 <connected> [IPv4 ('127.0.0.1', 29092)]>: Closing connection. KafkaConnectionError: Socket EVENT_READ without in-flight-requests
2025-05-02 10:12:43,938 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:29092 <connecting> [IPv4 ('127.0.0.1', 29092)]>: connecting to localhost:29092 [('127.0.0.1', 29092) IPv4]
2025-05-02 10:12:43,938 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:29092 <connected> [IPv4 ('127.0.0.1', 29092)]>: Connection complete.
