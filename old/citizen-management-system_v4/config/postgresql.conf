#------------------------------------------------------------------------------
# CUSTOM SETTINGS FOR QLDCQG
#------------------------------------------------------------------------------

# Add required extensions to preload
# Đảm bảo các extension này đã được cài đặt gói OS tương ứng trong Dockerfile
shared_preload_libraries = 'pg_stat_statements,pgaudit,pg_cron' # Thêm các extension khác nếu cần preload

# Configure pg_cron database
# Chỉ định database mà pg_cron sẽ lưu trữ và đọc job từ đó
cron.database_name = 'national_citizen_central_server'

# Configure pgaudit (Ví dụ cơ bản - xem tài liệu pgaudit để biết thêm chi tiết)
pgaudit.log = 'all'              # Log tất cả các lệnh (có thể là 'read', 'write', 'ddl', 'role'...)
pgaudit.log_catalog = off        # Không log các lệnh trong catalog hệ thống
pgaudit.log_parameter = on       # Log các tham số của câu lệnh
pgaudit.log_relation = on        # Log các bảng được truy cập trong câu lệnh SELECT/DML
pgaudit.log_statement_once = off # Log mỗi statement trong transaction hay chỉ log lần đầu

# Configure pg_stat_statements (Ví dụ cơ bản)
pg_stat_statements.max = 10000    # Số lượng câu lệnh tối đa để theo dõi
pg_stat_statements.track = all    # Theo dõi cả top-level và nested statements

# Other performance tuning parameters (adjust based on resources)
# listen_addresses = '*' # Đã được set mặc định trong image postgres/postgis
max_connections = 100
shared_buffers = 1GB # Điều chỉnh theo RAM của container/máy host
effective_cache_size = 3GB # Điều chỉnh theo RAM
maintenance_work_mem = 256MB
checkpoint_completion_target = 0.9
wal_buffers = 16MB
default_statistics_target = 100
random_page_cost = 1.1
effective_io_concurrency = 200 # Cho SSDs
work_mem = 16MB # Điều chỉnh tùy theo query phức tạp
min_wal_size = 1GB
max_wal_size = 4GB

# Logging (Ví dụ)
log_destination = 'stderr'
logging_collector = on
log_directory = 'log'
log_filename = 'postgresql-%Y-%m-%d_%H%M%S.log'
log_statement = 'ddl' # Log các lệnh DDL
log_min_duration_statement = 250ms # Log các câu lệnh chạy chậm hơn 250ms

# Locale and Formatting (Thường được kế thừa từ initdb, nhưng có thể đặt ở đây)
# lc_messages = 'en_US.UTF-8'
# lc_monetary = 'en_US.UTF-8'
# lc_numeric = 'en_US.UTF-8'
# lc_time = 'en_US.UTF-8'
# default_text_search_config = 'pg_catalog.simple' # Hoặc 'public.vietnamese' sau khi tạo

# Include other standard postgresql.conf settings below...
# ... (phần còn lại của file postgresql.conf gốc) ...

